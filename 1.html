<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>人格类型预测评估系统</title>
    <!-- 替换为国内稳定的 BootCDN 源 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.bootcdn.net/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
    
    <!-- Google Fonts (可选，如果字体加载慢可以注释掉) -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- 自定义样式配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Noto Sans SC"', 'system-ui', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'sans-serif'],
                    },
                    colors: {
                        primary: '#6366f1', // Indigo-500
                        primaryDark: '#4f46e5', // Indigo-600
                        secondary: '#10b981', // Emerald-500
                        introvert: '#3b82f6', // Blue-500
                        extrovert: '#f59e0b', // Amber-500
                        surface: '#ffffff',
                        background: '#f8fafc',
                    },
                    boxShadow: {
                        'soft': '0 4px 6px -1px rgba(0, 0, 0, 0.02), 0 2px 4px -1px rgba(0, 0, 0, 0.02)',
                        'glow': '0 0 15px rgba(99, 102, 241, 0.3)',
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .glass-panel {
                @apply bg-white/80 backdrop-blur-md border border-white/20 shadow-xl;
            }
            .input-group {
                @apply relative transition-all duration-300;
            }
            .input-field {
                @apply w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:bg-white focus:border-primary focus:ring-4 focus:ring-primary/10 focus:outline-none transition-all duration-300 text-gray-700 placeholder-gray-400;
            }
            .input-icon {
                @apply absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 transition-colors duration-300 z-10 w-5 text-center;
            }
            .input-field:focus ~ .input-icon {
                @apply text-primary;
            }
            
            /* Radio Button Cards */
            .radio-card-label {
                @apply flex items-center justify-center gap-2 p-3 border-2 border-transparent bg-gray-50 rounded-xl cursor-pointer transition-all duration-200 hover:bg-gray-100 text-gray-600 font-medium;
            }
            .radio-input:checked + .radio-card-label {
                @apply border-primary bg-primary/5 text-primary shadow-sm;
            }

            .btn-primary-gradient {
                @apply bg-gradient-to-r from-primary to-primaryDark text-white px-8 py-3.5 rounded-xl font-bold shadow-lg shadow-primary/30 hover:shadow-primary/50 hover:-translate-y-0.5 active:translate-y-0 transition-all duration-300 flex items-center justify-center gap-2 tracking-wide;
            }

            /* Hide number input spinners */
            input[type=number]::-webkit-inner-spin-button, 
            input[type=number]::-webkit-outer-spin-button { 
                -webkit-appearance: none; 
                margin: 0; 
            }
        }

        /* Animation for result reveal */
        @keyframes slideUpFade {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-result {
            animation: slideUpFade 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }
        
        body {
            background-image: radial-gradient(circle at top right, #e0e7ff 0%, #f3f4f6 40%, #ffffff 100%);
            background-attachment: fixed;
        }
    </style>
</head>
<body class="min-h-screen text-gray-600 selection:bg-primary/20 selection:text-primary pb-12">
    
    <!-- 装饰背景元素 -->
    <div class="fixed top-0 left-0 w-full h-full overflow-hidden -z-10 pointer-events-none">
        <div class="absolute -top-[10%] -right-[5%] w-[500px] h-[500px] bg-primary/5 rounded-full blur-3xl"></div>
        <div class="absolute top-[20%] -left-[10%] w-[400px] h-[400px] bg-secondary/5 rounded-full blur-3xl"></div>
    </div>

    <!-- 顶部导航栏 -->
    <header class="sticky top-0 z-50 glass-panel border-b border-gray-100">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-primaryDark flex items-center justify-center shadow-lg shadow-primary/20 text-white">
                    <i class="fa fa-snowflake-o text-xl" aria-hidden="true"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold text-gray-800 tracking-tight leading-none">MindMirror</h1>
                    <span class="text-xs text-primary font-medium tracking-wider uppercase">AI Personality Lab</span>
                </div>
            </div>
            <div class="hidden md:flex items-center text-xs font-medium bg-gray-100/80 px-3 py-1.5 rounded-full text-gray-500 border border-gray-200">
                <i class="fa fa-bolt text-amber-500 mr-1.5" aria-hidden="true"></i>
                基于机器学习模型驱动
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 max-w-6xl">
        
        <!-- 头部引导区 -->
        <div class="text-center mb-10 mt-4 animate-result" style="animation-delay: 0.1s;">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-3">探索你的<span class="text-transparent bg-clip-text bg-gradient-to-r from-primary to-purple-600">内在性格</span>特质</h2>
            <p class="text-gray-500 max-w-2xl mx-auto text-sm md:text-base">通过分析日常行为模式与社交习惯，精准预测您的内向/外向倾向。请基于真实情况填写以下数据。</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
            <!-- 左侧：特征输入区 -->
            <div class="lg:col-span-7 xl:col-span-8 animate-result" style="animation-delay: 0.2s;">
                <div class="bg-white rounded-2xl shadow-xl shadow-gray-200/50 border border-white/50 overflow-hidden">
                    <div class="px-6 py-5 border-b border-gray-100 bg-gray-50/30 flex items-center justify-between">
                        <h2 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                            <span class="w-1 h-5 rounded-full bg-primary block"></span>
                            特征数据录入
                        </h2>
                        <span class="text-xs text-gray-400 bg-white px-2 py-1 rounded border border-gray-100">共 7 项指标</span>
                    </div>
                    
                    <div class="p-6 md:p-8">
                        <form id="predictionForm" class="space-y-8">
                            <!-- 数值型特征组 -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-8">
                                <!-- 1. 独处时间 -->
                                <div class="input-group">
                                    <label for="timeAlone" class="block text-sm font-semibold text-gray-700 mb-2 ml-1">
                                        独处时间 <span class="text-xs font-normal text-gray-400">/天</span>
                                    </label>
                                    <div class="relative">
                                        <input 
                                            type="number" 
                                            id="timeAlone" 
                                            min="0" 
                                            max="24" 
                                            step="0.5" 
                                            required
                                            class="input-field"
                                            placeholder="0-12 小时"
                                        >
                                        <i class="fa fa-coffee input-icon" aria-hidden="true"></i>
                                    </div>
                                    <p class="text-xs text-gray-400 mt-1.5 ml-1">每天独自度过的清醒时间</p>
                                </div>

                                <!-- 2. 社交活动参与度 -->
                                <div class="input-group">
                                    <label for="socialAttendance" class="block text-sm font-semibold text-gray-700 mb-2 ml-1">
                                        社交频率 <span class="text-xs font-normal text-gray-400">/周</span>
                                    </label>
                                    <div class="relative">
                                        <input 
                                            type="number" 
                                            id="socialAttendance" 
                                            min="0" 
                                            max="21" 
                                            step="1" 
                                            required
                                            class="input-field"
                                            placeholder="0-10 次"
                                        >
                                        <i class="fa fa-users input-icon" aria-hidden="true"></i>
                                    </div>
                                    <p class="text-xs text-gray-400 mt-1.5 ml-1">每周聚会/聚餐次数</p>
                                </div>

                                <!-- 3. 外出频率 -->
                                <div class="input-group">
                                    <label for="goingOutside" class="block text-sm font-semibold text-gray-700 mb-2 ml-1">
                                        外出次数 <span class="text-xs font-normal text-gray-400">/天</span>
                                    </label>
                                    <div class="relative">
                                        <input 
                                            type="number" 
                                            id="goingOutside" 
                                            min="0" 
                                            max="10" 
                                            step="1" 
                                            required
                                            class="input-field"
                                            placeholder="0-6 次"
                                        >
                                        <i class="fa fa-bicycle input-icon" aria-hidden="true"></i>
                                    </div>
                                    <p class="text-xs text-gray-400 mt-1.5 ml-1">非通勤目的的出门次数</p>
                                </div>

                                <!-- 4. 朋友圈大小 -->
                                <div class="input-group">
                                    <label for="friendsCircle" class="block text-sm font-semibold text-gray-700 mb-2 ml-1">
                                        核心朋友圈 <span class="text-xs font-normal text-gray-400">人数</span>
                                    </label>
                                    <div class="relative">
                                        <input 
                                            type="number" 
                                            id="friendsCircle" 
                                            min="0" 
                                            max="500" 
                                            step="1" 
                                            required
                                            class="input-field"
                                            placeholder="5-100 人"
                                        >
                                        <i class="fa fa-address-book-o input-icon" aria-hidden="true"></i>
                                    </div>
                                    <p class="text-xs text-gray-400 mt-1.5 ml-1">月度至少联系一次的朋友数</p>
                                </div>

                                <!-- 5. 发帖频率 -->
                                <div class="input-group md:col-span-2">
                                    <label for="postFrequency" class="block text-sm font-semibold text-gray-700 mb-2 ml-1">
                                        社交平台活跃度 <span class="text-xs font-normal text-gray-400">/周</span>
                                    </label>
                                    <div class="relative">
                                        <input 
                                            type="number" 
                                            id="postFrequency" 
                                            min="0" 
                                            max="100" 
                                            step="1" 
                                            required
                                            class="input-field"
                                            placeholder="朋友圈/微博/动态发布次数"
                                        >
                                        <i class="fa fa-share-alt input-icon" aria-hidden="true"></i>
                                    </div>
                                </div>
                            </div>

                            <hr class="border-gray-100 border-dashed">

                            <!-- 分类型特征组 -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- 6. 舞台恐惧 -->
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-3 ml-1">
                                        是否存在舞台/演讲恐惧？
                                    </label>
                                    <div class="grid grid-cols-2 gap-3">
                                        <label class="relative">
                                            <input type="radio" name="stageFear" value="Yes" required class="radio-input sr-only peer">
                                            <div class="radio-card-label peer-checked:ring-2 ring-primary ring-offset-1">
                                                <i class="fa fa-check-circle-o text-lg" aria-hidden="true"></i> 
                                                <span>是</span>
                                            </div>
                                        </label>
                                        <label class="relative">
                                            <input type="radio" name="stageFear" value="No" class="radio-input sr-only peer">
                                            <div class="radio-card-label peer-checked:ring-2 ring-primary ring-offset-1">
                                                <i class="fa fa-times-circle-o text-lg" aria-hidden="true"></i>
                                                <span>否</span>
                                            </div>
                                        </label>
                                    </div>
                                </div>

                                <!-- 7. 社交后疲惫 -->
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-3 ml-1">
                                        社交后是否感到精力耗尽？
                                    </label>
                                    <div class="grid grid-cols-2 gap-3">
                                        <label class="relative">
                                            <input type="radio" name="drainedAfterSocial" value="Yes" required class="radio-input sr-only peer">
                                            <div class="radio-card-label peer-checked:ring-2 ring-primary ring-offset-1">
                                                <i class="fa fa-battery-empty text-lg" aria-hidden="true"></i>
                                                <span>是</span>
                                            </div>
                                        </label>
                                        <label class="relative">
                                            <input type="radio" name="drainedAfterSocial" value="No" class="radio-input sr-only peer">
                                            <div class="radio-card-label peer-checked:ring-2 ring-primary ring-offset-1">
                                                <i class="fa fa-battery-full text-lg" aria-hidden="true"></i>
                                                <span>否</span>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- 提交按钮 -->
                            <div class="pt-2">
                                <button type="submit" class="btn-primary-gradient w-full group">
                                    <i class="fa fa-magic group-hover:rotate-12 transition-transform duration-300" aria-hidden="true"></i> 
                                    <span>开始智能分析</span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- 右侧：预测结果区 -->
            <div class="lg:col-span-5 xl:col-span-4 sticky top-24 animate-result" style="animation-delay: 0.3s;">
                <!-- 结果展示卡片 -->
                <div class="bg-white rounded-2xl shadow-xl shadow-gray-200/50 border border-white/50 overflow-hidden relative min-h-[400px]">
                    <!-- 装饰背景 -->
                    <div class="absolute top-0 w-full h-1 bg-gradient-to-r from-introvert to-extrovert"></div>

                    <div class="px-6 py-5 border-b border-gray-100 flex items-center justify-between">
                        <h2 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                            <i class="fa fa-pie-chart text-primary" aria-hidden="true"></i> 分析报告
                        </h2>
                        <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                    </div>
                    
                    <div class="p-6">
                        <!-- 结果占位区 -->
                        <div id="resultPlaceholder" class="py-12 flex flex-col items-center justify-center text-center">
                            <div class="w-20 h-20 rounded-full bg-gray-50 flex items-center justify-center mb-6 relative">
                                <i class="fa fa-search text-3xl text-gray-300" aria-hidden="true"></i>
                                <div class="absolute inset-0 border-4 border-gray-100 rounded-full border-t-primary animate-spin hidden" id="loadingSpinner"></div>
                            </div>
                            <h3 class="text-gray-800 font-medium mb-2">等待数据输入</h3>
                            <p class="text-sm text-gray-400 px-8">请完整填写左侧特征信息，AI 模型将即时为您生成人格画像。</p>
                        </div>
                        
                        <!-- 结果展示区（默认隐藏） -->
                        <div id="resultDisplay" class="hidden">
                            <!-- 人格类型结果卡片 -->
                            <div id="personalityCard" class="relative overflow-hidden text-center py-8 rounded-2xl mb-6 transition-all duration-500 transform hover:scale-[1.02]">
                                <div class="relative z-10">
                                    <h3 class="text-xs uppercase tracking-widest font-bold opacity-70 mb-2">预测结果</h3>
                                    <p class="text-3xl md:text-4xl font-black mb-2 tracking-tight" id="personalityResult"></p>
                                    <div class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full bg-white/20 backdrop-blur-sm text-sm font-medium">
                                        <i class="fa fa-check-circle" aria-hidden="true"></i>
                                        <span id="confidenceText"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 概率分布图 -->
                            <div class="mb-8">
                                <div class="flex items-center justify-between mb-4">
                                    <h3 class="text-sm font-bold text-gray-700">类型概率分布</h3>
                                </div>
                                <div class="h-48 relative">
                                    <canvas id="probabilityChart"></canvas>
                                    <!-- Center Text Overlay -->
                                    <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                                        <span class="text-xs text-gray-400 font-medium">VS</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 关键特征分析 -->
                            <div class="bg-gray-50 rounded-xl p-4 border border-gray-100">
                                <h3 class="text-xs font-bold text-gray-400 uppercase mb-3 flex items-center gap-2">
                                    <i class="fa fa-sliders" aria-hidden="true"></i> 关键影响因子
                                </h3>
                                <div id="featureAnalysis" class="space-y-3">
                                    <!-- 动态生成特征分析内容 -->
                                </div>
                            </div>
                            
                            <!-- 重新预测按钮 -->
                            <button id="resetBtn" class="w-full mt-6 bg-white border-2 border-gray-100 text-gray-600 px-4 py-3 rounded-xl font-bold hover:bg-gray-50 hover:border-gray-200 hover:text-primary transition-colors duration-300 flex items-center justify-center gap-2 text-sm">
                                <i class="fa fa-refresh" aria-hidden="true"></i> 重新测试
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 数据说明小字 -->
                <div class="mt-4 px-4">
                    <p class="text-xs text-center text-gray-400 leading-relaxed">
                        <i class="fa fa-shield mr-1" aria-hidden="true"></i>
                        数据安全声明：您的所有输入仅在本地浏览器进行计算处理，不会上传至任何服务器。
                    </p>
                </div>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="mt-12 py-8 border-t border-gray-100">
        <div class="container mx-auto px-4 text-center">
            <p class="text-sm text-gray-400 font-medium">© 2025 人格类型预测评估系统</p>
            <p class="text-xs text-gray-300 mt-2">Design Enhanced with Tailwind CSS</p>
        </div>
    </footer>

    <!-- 核心交互逻辑 (完全保持原样) -->
    <script>
        // 等待页面加载完成
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('predictionForm');
            const resultPlaceholder = document.getElementById('resultPlaceholder');
            const resultDisplay = document.getElementById('resultDisplay');
            const personalityResult = document.getElementById('personalityResult');
            const confidenceText = document.getElementById('confidenceText');
            const personalityCard = document.getElementById('personalityCard');
            const featureAnalysis = document.getElementById('featureAnalysis');
            const resetBtn = document.getElementById('resetBtn');
            let probabilityChart = null;

            // Loading 动画控制
            const loadingSpinner = document.getElementById('loadingSpinner');
            const placeholderIcon = resultPlaceholder.querySelector('.fa-search');

            // 表单提交事件
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // 1. 获取表单输入值
                const formData = {
                    timeAlone: parseFloat(document.getElementById('timeAlone').value),
                    socialAttendance: parseInt(document.getElementById('socialAttendance').value),
                    goingOutside: parseInt(document.getElementById('goingOutside').value),
                    friendsCircle: parseInt(document.getElementById('friendsCircle').value),
                    postFrequency: parseInt(document.getElementById('postFrequency').value),
                    stageFear: document.querySelector('input[name="stageFear"]:checked').value,
                    drainedAfterSocial: document.querySelector('input[name="drainedAfterSocial"]:checked').value
                };

                // UI美化：显示加载状态
                placeholderIcon.classList.add('hidden');
                loadingSpinner.classList.remove('hidden');
                resultPlaceholder.querySelector('h3').textContent = "正在分析数据...";
                resultPlaceholder.querySelector('p').textContent = "AI模型正在计算各维度权重";

                // 3. 模拟预测延迟（实际项目中删除，直接调用API）
                setTimeout(() => {
                    // 基于输入特征生成预测结果（实际项目中替换为模型返回结果）
                    const predictionResult = generatePrediction(formData);
                    
                    // 4. 展示预测结果
                    displayResult(predictionResult, formData);
                    
                    // 5. 切换显示状态
                    resultPlaceholder.classList.add('hidden');
                    resultDisplay.classList.remove('hidden');
                    resultDisplay.classList.add('animate-result'); // 添加进入动画
                }, 1500);
            });

            // 重新预测按钮事件
            resetBtn.addEventListener('click', function() {
                form.reset();
                resultDisplay.classList.add('hidden');
                resultDisplay.classList.remove('animate-result');
                resultPlaceholder.classList.remove('hidden');
                
                // 恢复 Placeholder 初始状态
                placeholderIcon.classList.remove('hidden');
                loadingSpinner.classList.add('hidden');
                resultPlaceholder.querySelector('h3').textContent = "等待数据输入";
                resultPlaceholder.querySelector('p').textContent = "请完整填写左侧特征信息，AI 模型将即时为您生成人格画像。";

                // 销毁已存在的图表
                if (probabilityChart) {
                    probabilityChart.destroy();
                }
                
                // 滚动回顶部
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            /**
             * 模拟模型预测（实际项目中替换为后端API调用）
             * @param {Object} data - 表单输入数据
             * @returns {Object} 预测结果（类型、概率、关键特征）
             */
            function generatePrediction(data) {
                // 基于特征计算内向/外向得分（模拟模型逻辑）
                let introvertScore = 0;
                let extrovertScore = 0;

                // 独处时间：越长内向得分越高
                introvertScore += (data.timeAlone / 12) * 30;
                extrovertScore -= (data.timeAlone / 12) * 20;

                // 社交活动参与度：越高外向得分越高
                extrovertScore += (data.socialAttendance / 10) * 25;
                introvertScore -= (data.socialAttendance / 10) * 15;

                // 社交后疲惫：是则内向得分高
                if (data.drainedAfterSocial === 'Yes') {
                    introvertScore += 20;
                    extrovertScore -= 10;
                } else {
                    extrovertScore += 15;
                    introvertScore -= 5;
                }

                // 舞台恐惧：是则内向得分高
                if (data.stageFear === 'Yes') {
                    introvertScore += 15;
                    extrovertScore -= 5;
                } else {
                    extrovertScore += 10;
                    introvertScore -= 5;
                }

                // 朋友圈大小：越大外向得分高
                extrovertScore += (data.friendsCircle / 100) * 10;
                introvertScore -= (data.friendsCircle / 100) * 5;

                // 外出频率：越高外向得分高
                extrovertScore += (data.goingOutside / 6) * 10;
                introvertScore -= (data.goingOutside / 6) * 5;

                // 发帖频率：越高外向得分高
                extrovertScore += (data.postFrequency / 30) * 10;
                introvertScore -= (data.postFrequency / 30) * 5;

                // 计算概率（归一化）
                const total = Math.abs(introvertScore) + Math.abs(extrovertScore);
                const introvertProb = Math.max(0, introvertScore / total);
                const extrovertProb = Math.max(0, extrovertScore / total);

                // 确定最终类型和置信度
                let personalityType = '';
                let confidence = 0;
                if (introvertProb > extrovertProb) {
                    personalityType = '内向型 (Introvert)';
                    confidence = introvertProb;
                } else {
                    personalityType = '外向型 (Extrovert)';
                    confidence = extrovertProb;
                }

                // 分析关键影响特征
                const keyFeatures = analyzeKeyFeatures(data);

                return {
                    type: personalityType,
                    confidence: (confidence * 100).toFixed(1),
                    probabilities: {
                        内向型: (introvertProb * 100).toFixed(1),
                        外向型: (extrovertProb * 100).toFixed(1)
                    },
                    keyFeatures: keyFeatures
                };
            }

            /**
             * 分析关键影响特征
             * @param {Object} data - 表单输入数据
             * @returns {Array} 关键特征列表
             */
            function analyzeKeyFeatures(data) {
                const features = [];

                // 独处时间分析
                if (data.timeAlone >= 6) {
                    features.push('独处时间较长（≥6小时/天），倾向内向型');
                } else if (data.timeAlone <= 2) {
                    features.push('独处时间较短（≤2小时/天），倾向外向型');
                }

                // 社交活动分析
                if (data.socialAttendance >= 5) {
                    features.push('社交活动频繁（≥5次/周），倾向外向型');
                } else if (data.socialAttendance <= 1) {
                    features.push('社交活动较少（≤1次/周），倾向内向型');
                }

                // 社交后疲惫分析
                if (data.drainedAfterSocial === 'Yes') {
                    features.push('社交后感到疲惫，倾向内向型');
                } else {
                    features.push('社交后无疲惫感，倾向外向型');
                }

                // 舞台恐惧分析
                if (data.stageFear === 'Yes') {
                    features.push('存在舞台恐惧，倾向内向型');
                }

                // 朋友圈大小分析
                if (data.friendsCircle >= 50) {
                    features.push('朋友圈较大（≥50人），倾向外向型');
                } else if (data.friendsCircle <= 10) {
                    features.push('朋友圈较小（≤10人），倾向内向型');
                }

                return features.slice(0, 3); // 返回前3个关键特征
            }

            /**
             * 展示预测结果
             * @param {Object} result - 预测结果
             * @param {Object} data - 表单输入数据
             */
            function displayResult(result, data) {
                // 1. 展示人格类型和置信度
                personalityResult.textContent = result.type;
                confidenceText.textContent = `置信度：${result.confidence}%`;

                // 设置结果卡片颜色 (UI美化：使用渐变色)
                if (result.type.includes('内向')) {
                    personalityCard.className = 'relative overflow-hidden text-center py-8 rounded-2xl mb-6 bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-lg shadow-blue-500/30';
                    personalityResult.className = 'text-3xl md:text-4xl font-black mb-2 tracking-tight text-white';
                } else {
                    personalityCard.className = 'relative overflow-hidden text-center py-8 rounded-2xl mb-6 bg-gradient-to-br from-amber-400 to-orange-500 text-white shadow-lg shadow-orange-500/30';
                    personalityResult.className = 'text-3xl md:text-4xl font-black mb-2 tracking-tight text-white';
                }

                // 2. 绘制概率分布图表 (UI美化：更现代的图表配置)
                const ctx = document.getElementById('probabilityChart').getContext('2d');
                // 销毁已存在的图表
                if (probabilityChart) {
                    probabilityChart.destroy();
                }
                // 创建新图表
                probabilityChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: Object.keys(result.probabilities),
                        datasets: [{
                            data: Object.values(result.probabilities).map(Number),
                            backgroundColor: [
                                '#3B82F6', // 内向型颜色
                                '#F59E0B'  // 外向型颜色
                            ],
                            borderColor: '#ffffff',
                            borderWidth: 0,
                            hoverOffset: 10,
                            borderRadius: 5 // 圆角
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        cutout: '75%', // 更细的环
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    usePointStyle: true,
                                    padding: 20,
                                    font: {
                                        family: "'Noto Sans SC', sans-serif",
                                        size: 12
                                    },
                                    color: '#6b7280'
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(255, 255, 255, 0.95)',
                                titleColor: '#1f2937',
                                bodyColor: '#4b5563',
                                borderColor: '#e5e7eb',
                                borderWidth: 1,
                                padding: 12,
                                displayColors: true,
                                callbacks: {
                                    label: function(context) {
                                        return `${context.label}: ${context.raw}%`;
                                    }
                                }
                            }
                        },
                        animation: {
                            animateScale: true,
                            animateRotate: true
                        }
                    }
                });

                // 3. 展示关键特征分析 (UI美化：更漂亮的列表样式)
                featureAnalysis.innerHTML = '';
                result.keyFeatures.forEach((feature, index) => {
                    const featureItem = document.createElement('div');
                    featureItem.className = 'flex items-center gap-3 bg-white p-3 rounded-lg border border-gray-100 shadow-sm transition-transform hover:translate-x-1 duration-200';
                    
                    // 根据特征内容选择图标颜色
                    let iconColorClass = 'text-gray-400';
                    if(feature.includes('内向')) iconColorClass = 'text-introvert';
                    else if(feature.includes('外向')) iconColorClass = 'text-extrovert';

                    featureItem.innerHTML = `
                        <div class="w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center shrink-0">
                            <i class="fa fa-quote-left ${iconColorClass} text-xs" aria-hidden="true"></i>
                        </div>
                        <span class="text-sm text-gray-600 font-medium">${feature}</span>
                    `;
                    featureAnalysis.appendChild(featureItem);
                });
            }
        });
    </script>
</body>
</html>